= Изменить расположение пользовательской документации

При обращении к документации из программ {wincl} и {wc}, пользователь по умолчанию направлен на https://docsvision.com[сайт компании ДоксВижн].

При необходимости администратор может разместить документы на ресурсах своей организации. Для этого необходимо изменить шаблон, по которому определяется расположение документации в программе _{cns}_.

.Настройка расположения документации
image::admin:help-url.png[Настройка расположения документации]

Расположение пользовательской документации можно изменить в конфигурационном файле модуля {pl} в параметре `"HelpUrl"`.

[source,json]
----
{
  "DocsVision": {
    "Platform": {
      "Server": {
        "Site": {
          "HelpUrl": "http://help.docsvision.com/{client}/{version}",
          "InstallLogPath": null, <.>
          "InstallAction": 0, <.>
          "InstallUILevel": 0, <.>
          "InstallScope": 0  <.>
        }
      }
    }
  }
}
----
<.> Папка журналов установки.
<.> Установка решений: `0` -- по умолчанию, `1` -- не инсталлировать, `2` -- полная установка, `3` -- режим Advertise.
<.> Интерфейс установки: `0` -- по умолчанию, `1` -- не отображать, `2` -- минимальный интерфейс, `3` -- сокращённый интерфейс, `4` -- полный интерфейс.
<.> Область установки: `0` -- для текущего пользователя, `1` -- для всех пользователей, `2` -- определять автоматически, при наличии полномочий устанавливается для всех пользователей, иначе только для текущего пользователя..

[#templates]
== Шаблоны расположения документации

.В шаблоне могут быть использованы переменные:
* `\{client}` -- псевдоним клиентской программы, который может приобретать значения:
** `winclient` -- для {wincl}а.
** `webclient` -- для {wc}а.
+
[NOTE]
====
Другие клиентские приложения не поддерживают настройку, определяющую расположение документации.
====
+
* `\{version}` -- версия клиентской программы.

Таким образом фактический стандартный адрес документации, к примеру, для модуля {pl} версии {page-version} будет следующим: `\http://help.docsvision.com/platform/{page-version}/`.

WARNING: Для всех клиентских программ используется общий шаблон, поэтому размещать документацию {wincl}а и {wc}а следует на одном сайте.

[#location]
== Изменение расположения документации

Новая документация {dv} разворачивается с помощью https://docs.antora.org/[генератора статических сайтов Antora].

Для первой сборки сайта потребуется подключение к интернету, в будущем интернет-соединение опционально и потребуется только для получения последних изменений в документации.

[#assembly]
=== Сборка сайта

.Выполните указанные ниже действия последовательно:
. Перейдите https://git-scm.com/download/win[по ссылке], скачайте и установите git.
. Установите Node.js предпочтительным способом или скачайте инсталлятор https://nodejs.org/en/download/[с официального сайта].
. Скопируйте на компьютер данный (https://github.com/Grolribasi/antora-playbook[Docsvision/antora-playbook]) репозиторий.
+
* Выполните в Powershell:
+
 git clone https://github.com/Grolribasi/antora-playbook.git
+
. Перейдите в каталог репозитория:
+
 cd antora-playbook
+
. Установите Antora командой:
+
 npm i
+
. Откройте файл `/antora-playbook/antora-playbook.yml` в любом текстовом редакторе и при необходимости отредактируйте URL сайта:
+
[source,yaml]
----
site:
  title: Документация Docsvision
  url: https://help.docsvision.com/ <.>
  robots: allow
----
<.> Укажите адрес сервера, на котором будет развёрнута документация.
+
. Запустите сборку сайта при помощи Antora, выполнив следующую команду в окне Powershell:
+
[source]
----
npx antora antora-playbook.yml
----
+
. Файлы сайта будут расположены в папке `wwwroot`.

[#view]
== Просмотр сайта

.Сайт можно просматривать:
** Локально -- нажмите на сгенерированные html-файлы, расположенные в папке `wwwroot`.
** С простого http-сервера -- выполните шаги ниже.

.Чтобы развернуть сайт на локальном сервере:
. Перейдите в папку репозитория `antora-playbook`.
. Установите локальный http-сервер следующей командой:
+
 antora-playbook $ npm i -g http-server
+
. Выполните команду `http-server`, например, так:
+
 antora-playbook\wwwroot $ http-server build/site -c-1 -p 5000
+
. После запуска команды, локальный адрес веб-сервера будет отображён в окне консоли следующим образом:
+
[source]
----
Starting up http-server, serving antora-playbook\wwwroot
Available on:
  http://127.0.0.1:5000
  http://192.168.1.8:5000
Hit CTRL-C to stop the server
----
+
. Вставьте любой адрес из списка в строку браузера, что просмотреть сайт через локальный веб-сервер.

[#limit]
=== Ограничения

В собранном сайте не будет работать поиск. Чтобы воспользоваться функциями локального (офлайн) поиска, рекомендуется использовать расширение Antora Lunr Search. Подробная инструкция по разворачиванию приведена https://www.npmjs.com/package/antora-lunr[по ссылке].

Перед использованием расширения Antora Lunr Search рекомендуется удалить папку `antora-playbook/supplemental-ui`.
