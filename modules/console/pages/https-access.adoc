:page-layout: home

= Доступ к Storage Server по HTTPS

При необходимости можно настроить доступ к *{sss-new}* по протоколу HTTPS, для этого потребуется выполнить настройки, описанные далее.

. Установите пакет `openssl` командой:
+
[tabs]
====
Astra Linux::
+
 $ sudo apt-get install openssl

РЕД ОС::
+
 $ sudo dnf install openssl
====
+
. [[before]]Создайте самопидписанный сертификат SSL.
+
[source,bash]
----
openssl req -x509 -newkey rsa:2048 -keyout docsvision.key -nodes -out certificate.crt -subj "/CN=example.company.com" <.>
----
<.> Замените `docsvision.key` и `certificate.crt` на собственные названия для ключа и сертификата, вместо `/CN=example.company.com` укажите адрес сервера {dv} на Linux, например, `/CN=help.docsvision.com`.
+
NOTE: Подробный пример создания сертификата приведён в документации {of-mc}, раздел "xref:engineer:ROOT:create-cert.adoc[]".
+
. Добавьте сертификат в доверенные, скопировав его в директорию `/usr/local/share/ca-certificates/`.
. Обновите список доверенных сертификатов:
+
[tabs]
====
Astra Linux::
+
 $ sudo update-ca-certificates

РЕД ОС::
+
 $ update-ca-trust
====
+
. Отредактируйте конфигурационный файл `appsettings.json`:
+
 $ sudo nano /usr/lib/docsvision/platform/appsettings.json
+
.Фрагмент конфигурационного файла:
----
"AllowedHosts": "*",
    "Kestrel": {
        "Endpoints": {
            "Https": {
                "Url": "https://*:5000",
                "Certificate": {
                    "Path": "/folder/certificate.crt", <.>
                    "KeyPath": "/folder/docsvision.key" <.>
                }
            }
        }
    }
}
----
<.> Локальное расположение сертификата, созданного <<before,ранее>>.
<.> Локальное расположение ключа шифрования для сертификата, созданного <<before,ранее>>.
+
. Измените также конфигурационный файл {wc} по адресу `/usr/lib/docsvision/webclient/appsettings.json`. Измените параметр `"ConnectionAddress"`, в котором необходимо указать адрес с `https`.
. Перезапустите службы *{sss-new}* и *{wcs-new}*.
+
. На машине с Windows, где планируется работа в {wincl}е, необходимо добавить созданный <<before,ранее>> сертификат в доверенные корневые сертификаты.
. Откройте {cns} на вкладке "xref:manage-access.adoc[]" и укажите адрес с `https` в полях _Адрес сервера при подключении_ и _Адрес сайта при подключении через внешнюю сеть или по HTTP_.
. Проверьте подключение. Если настройки выполнены корректно, {wc}, {wincl} и программа DVExplorer должны работать без ошибок, обновление БД также должно проходить без ошибок.
