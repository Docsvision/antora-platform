= Подключить полнотекстовый поиск Microsoft SQL Server

. Если требуется индексировать содержимое файлов PDF и Microsoft Office, выполните инструкцию, приведенную в пункте xref:search-pdf-office.adoc[].
include::admin:partial$excerpts.adoc[tags=openFullText]
. Нажмите кнопку *Добавить базу данных*, чтобы открыть окно добавления БД к сервису полнотекстового индексирования.
+
.Окно добавления БД к сервису полнотекстового индексирования
image::admin:add-db-to-fulltext.png[Окно добавления БД к сервису полнотекстового индексирования]
+
. В списке _Название базы_ выберите подключаемую БД Microsoft SQL Server. Нажмите *Далее*, чтобы продолжить настройку.
+
В списке баз данных отображаются БД, xref:db-settings.adoc[подключенные] к данному серверу {dv}.
+
. Настройте параметры подключения БД к системе полнотекстового поиска.
+
.Окно настройки параметров подключения БД к системе полнотекстового поиска
image::admin:fulltext-parameters-db.png[Окно настройки параметров подключения БД к системы полнотекстового поиска]
+
****
.. Если требуется, в поле _Полнотекстовое хранилище_ измените путь к каталогу файлов полнотекстовой группы. В поле должен быть указан локальный каталог на сервере баз данных.
+
Путь к хранилищу файлов полнотекстовой группы можно указать только при подключении БД к сервису полнотекстового индексирования. После завершения настройки путь можно изменить только следуя https://docs.microsoft.com/ru-ru/sql/t-sql/statements/alter-database-transact-sql-file-and-filegroup-options?view=sql-server-ver15[рекомендациям] https://docs.microsoft.com/ru-ru/sql/relational-databases/databases/move-user-databases?view=sql-server-ver15[Microsoft].
+
При повторном подключении БД к сервису полнотекстового индексирования в настройке _Полнотекстовое хранилище_ будет указан путь, который был указан до отключения этой БД от сервиса. Изменить путь можно только следуя рекомендациям Microsoft, ссылки на которые приведены выше.
+
.. Поле _Строка подключения к базе_ содержит неизменяемую строку подключения к БД, которая подключается к сервису полнотекстового индексирования.
.. В поле _Сервер {dv}_ должна быть указана строка подключения к службе *{sss}*.
+
Строка подключения имеет следующий вид: `ConnectAddress=http://company.com/DocsVision/StorageServer/StorageServerService.asmx`.
+
По умолчанию в поле отображается строка подключения к текущему серверу {dv}.
+
.. Если требуется, установите флаг `*Использовать внешнюю базу для карточек*` и/или `*Использовать внешнюю базу для файлов*`. В этом случае данные индексирования будут размещаться во внешней БД, вместо БД {dv}.
+
.При активном флаге "использовать внешнюю БД" следующие настройки станут доступны для изменения:
+
* `*Создавать внешнюю базу по умолчанию*` -- данные полнотекстового индексирования будут сохраняться в базу данных "Название-БД-{dv}_FT", которая будет создана на сервере БД с базой данных {dv}.
* `*Использовать существующую базу*` -- данные полнотекстового индексирования будут сохраняться в любую существующую базу данных (нажмите кнопку *…* и укажите данные для подключения к БД).
+
.. Добавьте языки, для построения полнотекстовых индексов с учетом морфологии языка нажатием кнопки *Добавить*. Языки будут добавлены в список _Полнотекстовые языки_.
+
В обычном случае, достаточно добавить русский язык. SQL Server должен поддерживать полнотекстовую индексацию с учетом морфологии выбранных языков.
+
.. Нажмите *Далее*, чтобы продолжить настройку.
****
+
. В следующем окне, установите переключатель в значение *Xml индексирование (рекомендуется)*
include::admin:partial$excerpts.adoc[tags=flagContinue]
+
.Окно выбора индексируемых типов карточек
image::admin:index-cards-select.png[Окно выбора индексируемых типов карточек]
+
. В следующем окне, установите переключатель в значение *Индексировать оперативные файлы* или *Индексировать оперативные и архивные файлы*
include::admin:partial$excerpts.adoc[tags=flagContinue]
+
.Окно выбора индексируемых типов файлов
image::admin:index-files.png[Окно выбора индексируемых типов файлов]
+
. Настройте параметры индексирования и обновления индексов.
+
.Окно настройки параметров индексирования
image::admin:index-parameters.png[Окно настройки параметров индексирования]
+
****
* _Максимальный размер транзакции_ --
include::admin:partial$excerpts.adoc[tags=maxIndex]
* _Период инициализации индексов_ --
include::admin:partial$excerpts.adoc[tags=createIndex]
* _Обновлять индексы один раз в_ и _Обновлять индексы каждые_ --
include::admin:partial$excerpts.adoc[tags=updateIndex]
****
+
. Нажмите *Завершить*, чтобы подключить БД к сервису полнотекстового индексирования с текущими настройками.
+
База данных будет добавлена в список баз данных, использующих сервис полнотекстового индексирования.
+
. Включите индексирование добавленной базы данных.
+
include::admin:partial$indexingProperties.adoc[]
