= Изменить настройки {es}

Окно свойств индексирования для полнотекстового поиска {es} отличается от свойств xref:search-microsoft-change.adoc[Microsoft SQL Server].

Перед настройкой свойств индексирования убедитесь, что конфигурация {es} соответствует xref:ROOT:requirements-hardware.adoc#elastic[указанным] требованиям.

В окне _Свойства индексирования_ настраиваются индексируемые типы карточек, их поля, а также выбираются поля карточек, которые в дальнейшем будут использоваться как фасеты, необходимые для работы агрегации в {wc}е.

include::admin:partial$excerpts.adoc[tags=openIndexing]

.Окно настройки полнотекстового поиска в {es}
image::indexing-properties-elastic.png[Окно настройки полнотекстового поиска в {es}]

.Окно настройки содержит следующие элементы:

[#main]
== Вкладка "Главная"

Количество потоков:::
Определяет количество параллельных задач обновления индексов. В каждом потоке обрабатывается одна карточка -- для каждого потока обработки открывается сессия к серверу {dv}.
+
[NOTE]
====
При первоначальной настройке индексирования рекомендуется оставить значение по умолчанию (`100 потоков`).

После завершения обработки первоначального массива карточек (продолжительность определяется индивидуально), установите значение `10-20 потоков`.
====

[#cards]
== Вкладка "Карточки"

Индексируемые типы карточек:::
Настройки списка индексируемых типов карточек.

Тип поля:::
Тип поля, выбранного в дереве.

Доступно для индексирования:::
Возможность индексации данных поля, выбранного в дереве.

Анализировать поле:::
Включает/выключает использование анализатора текста для данных поля, выбранного в дереве.

Количество фрагментов индекса:::
Определяет количество шардов (shards) в индексе карточки, выбранной в дереве.

Индексируемые карточки:::
Список типов карточек, для которых включено индексирование.

Удалять первичные данные файлов после обработки:::
Включает автоматическое удаление исходных данных файлов после формирования данных для поиска (см. подробное описание в xref:search-elastic-configure.adoc#deleteSource[пункте]). Все индексы, имеющие в полях ссылки на файлы, буду построены заново, если флаг активен.

[#facets]
== Вкладка "Фасеты"

На вкладке можно настроить поля карточек, которые будут использоваться как фасеты {es}. Фасеты делают доступной агрегацию в {wc}е.

Если ни одно из полей не было выбрано в качестве фасета, БД подключится к сервису полнотекстового индексирования с имеющимися настройками, т.е. будет использоваться обычный полнотекстовый поиск.

Чтобы применить агрегацию по типу карточек, установите флаг `*Тип карточки*` (по умолчанию флаг установлен).

.Флаг "Тип карточки" снят
image::card-type-flag.png[Флаг "Тип карточки" снят]

Фасеты настраиваются аналогично индексированию карточек на предыдущей вкладке.

.Выбор индексов для фасетов
image::facets.png[Выбор индексов для фасетов]

Выбрать можно только те поля, что включены в индексы. Поля, не включённые в индекс будут недоступны для выбора.

Выбранные фасеты будут доступны для использования в {wc}е, см. xref:webclient:user:grid-aggregate.adoc[].

[#directories]
== Вкладка "Справочники"

Содержит дерево типов справочников для выбора типов индексируемых справочников и полей справочников.

WARNING: При изменении настроек индексирования карточек и/или справочников (на страницах _Карточки_, _Справочники_) существующие индексы будут удалены, все данные будут проиндексированы повторно. Изменяйте данные настройки только при необходимости.
